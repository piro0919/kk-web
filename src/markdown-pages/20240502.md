---
slug: "/blog/20240502"
date: "2024-05-02"
title: "Next.jsで使用していないファイルを洗い出すnpmパッケージを作りました"
---

久しぶりに npm パッケージをリリースしてみました。

[@piro0919/next-unused](https://www.npmjs.com/package/@piro0919/next-unused)

一応 Fork もとに [next-unused](https://www.npmjs.com/package/next-unused) があるのですが、実装はほぼ作り直しました。

以下、開発に至った経緯です。

---

いろんな現場にフロントエンドプログラマーとして途中から参画してきましたが。

どこの現場もコンポーネント設計がめちゃくちゃなので、そこの修正から始めることになることがほとんどだったりします。

で、コンポーネント設計を修正していると、果たしてこのコンポーネントは使用されているのかされていないのか、もうわけがわからなくなるケースが出てきます。

そこでふと『使用していないコンポーネントを洗い出してくれる npm パッケージってないのかなぁ…』と思いまして、調べてみたところ next-unused というパッケージに至りました。

ただこのパッケージ、alias 周りの挙動感が少し怪しい…最後のリリースから 3 年以上経っていますし、それなら自分で解析して作り直してみよう！という感じで作ってみました。

---

ということで解析してみたところ、このパッケージのコア部分は [madge](https://www.npmjs.com/package/madge) というパッケージを使用していまして。

ファイル同士の依存関係を洗い出しているのが madge らしく、世の中便利なパッケージがあるものだなぁと。

どうやら依存関係を画像でも出力できるみたいです、すごい。

alias の解決に多少苦戦したのですが、baseUrl を設定してあげたら無事動いて一安心でした。

---

正直なところ、実装感をいじれば Next.js に限らずなんでも使えそうですが、まぁとりあえずは良いかなと。

ぜひ使ってみて改善案やバグの報告をいただけると幸いです。
